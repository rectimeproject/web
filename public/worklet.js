(()=>{"use strict";var e={572:(e,t,r)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t,r){var s=r.value;if("function"!=typeof s)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(i(s)));var o=!1;return{configurable:!0,get:function(){if(o||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof s)return s;var r=s.bind(this);return o=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return r},set:function(e){s=e,delete this[t]}}),o=!1,r},set:function(e){s=e}}}function o(e){var t;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?t=Reflect.ownKeys(e.prototype):(t=Object.getOwnPropertyNames(e.prototype),"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e.prototype)))),t.forEach((function(t){if("constructor"!==t){var r=Object.getOwnPropertyDescriptor(e.prototype,t);"function"==typeof r.value&&Object.defineProperty(e.prototype,t,s(e,t,r))}})),e}function n(){return 1===arguments.length?o.apply(void 0,arguments):s.apply(void 0,arguments)}r.r(t),r.d(t,{boundClass:()=>o,boundMethod:()=>s,default:()=>n})},163:(e,t,r)=>{r.r(t),r.d(t,{Decoder:()=>f,Encoder:()=>a,RingBuffer:()=>_,constants:()=>n});class i{#e;#t;constructor(e){this.#e=e,this.#t=e.malloc(e.originalRuntime()._size_of_int())}value(){if(4!==this.#e.originalRuntime()._size_of_int())throw new Error("invalid integer byte size");return this.#e.view().getInt32(this.#t,!0)}set(e){this.#e.view().setInt32(this.#t,e,!0)}size(){return this.#e.originalRuntime()._size_of_int()}offset(){return this.#t}destroy(){this.#e.free(this.#t),this.#t=0}}class s{#r=new Set;constructor(){}add(e){this.#r.add(e)}destroy(){for(const e of this.#r)e.destroy()}}class o{#t;#i;#e;constructor(e,t){this.#e=e,this.#i=t,this.#t=e.malloc(t)}offset(){return this.#t}data(){return this.#e.subarray(this.#t,this.#t+this.#i)}size(){return this.#i}destroy(){this.#e.free(this.#t),this.#t=0}}const n={OPE_OK:0,OPE_BAD_ARG:-11,OPE_INTERNAL_ERROR:-13,OPE_UNIMPLEMENTED:-15,OPE_ALLOC_FAIL:-17,OPE_CANNOT_OPEN:-30,OPE_TOO_LATE:-31,OPE_INVALID_PICTURE:-32,OPE_INVALID_ICON:-33,OPE_WRITE_FAIL:-34,OPE_CLOSE_FAIL:-35,OPUS_OK:0,OPUS_BAD_ARG:-1,OPUS_BUFFER_TOO_SMALL:-2,OPUS_INTERNAL_ERROR:-3,OPUS_INVALID_PACKET:-4,OPUS_UNIMPLEMENTED:-5,OPUS_INVALID_STATE:-6,OPUS_ALLOC_FAIL:-7,OPUS_AUTO:-1e3,OPUS_BITRATE_MAX:-1,OPUS_APPLICATION_VOIP:2048,OPUS_APPLICATION_AUDIO:2049,OPUS_APPLICATION_RESTRICTED_LOWDELAY:2051,OPUS_SIGNAL_VOICE:3001,OPUS_SIGNAL_MUSIC:3002,OPUS_BANDWIDTH_NARROWBAND:1101,OPUS_BANDWIDTH_MEDIUMBAND:1102,OPUS_BANDWIDTH_WIDEBAND:1103,OPUS_BANDWIDTH_SUPERWIDEBAND:1104,OPUS_BANDWIDTH_FULLBAND:1105,OPUS_FRAMESIZE_ARG:5e3,OPUS_FRAMESIZE_2_5_MS:5001,OPUS_FRAMESIZE_5_MS:5002,OPUS_FRAMESIZE_10_MS:5003,OPUS_FRAMESIZE_20_MS:5004,OPUS_FRAMESIZE_40_MS:5005,OPUS_FRAMESIZE_60_MS:5006,OPUS_FRAMESIZE_80_MS:5007,OPUS_FRAMESIZE_100_MS:5008,OPUS_FRAMESIZE_120_MS:5009};class u{#s;#e;#o;constructor(e,t){this.#e=e,this.#o=new i(e),this.#s=t}setComplexity(e){return this.#e.originalRuntime()._opus_set_complexity(this.#s,e)===n.OPUS_OK}getComplexity(){if(this.#e.originalRuntime()._opus_get_complexity(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_COMPLEXITY");return this.#o.value()}setBitrate(e){return this.#e.originalRuntime()._opus_set_bitrate(this.#s,e)===n.OPUS_OK}getBitrate(){if(this.#e.originalRuntime()._opus_get_bitrate(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_BITRATE");return this.#o.value()}setVbr(e){return this.#e.originalRuntime()._opus_set_vbr(this.#s,e)===n.OPUS_OK}getVbr(){if(this.#e.originalRuntime()._opus_get_vbr(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_VBR");return this.#o.value()}setVbrConstraint(e){return this.#e.originalRuntime()._opus_set_vbr_constraint(this.#s,e)===n.OPUS_OK}getVbrConstraint(){if(this.#e.originalRuntime()._opus_get_vbr_constraint(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_VBR_CONSTRAINT");return this.#o.value()}setForceChannels(e){return this.#e.originalRuntime()._opus_set_force_channels(this.#s,e)===n.OPUS_OK}getForceChannels(){if(this.#e.originalRuntime()._opus_get_force_channels(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_FORCE_CHANNELS");return this.#o.value()}setMaxBandwidth(e){return this.#e.originalRuntime()._opus_set_max_bandwidth(this.#s,e)===n.OPUS_OK}getMaxBandwidth(){if(this.#e.originalRuntime()._opus_get_max_bandwidth(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_MAX_BANDWIDTH");return this.#o.value()}setBandwidth(e){return this.#e.originalRuntime()._opus_set_bandwidth(this.#s,e)===n.OPUS_OK}setSignal(e){return this.#e.originalRuntime()._opus_set_signal(this.#s,e)===n.OPUS_OK}getSignal(){if(this.#e.originalRuntime()._opus_get_signal(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_SIGNAL");return this.#o.value()}setApplication(e){return this.#e.originalRuntime()._opus_set_application(this.#s,e)===n.OPUS_OK}getApplication(){if(this.#e.originalRuntime()._opus_get_application(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_APPLICATION");return this.#o.value()}getLookahead(){if(this.#e.originalRuntime()._opus_get_lookahead(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_LOOKAHEAD");return this.#o.value()}setInbandFec(e){return this.#e.originalRuntime()._opus_set_inband_fec(this.#s,e)===n.OPUS_OK}getInbandFec(){if(this.#e.originalRuntime()._opus_get_inband_fec(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_INBAND_FEC");return this.#o.value()}setPacketLossperc(e){return this.#e.originalRuntime()._opus_set_packet_loss_perc(this.#s,e)===n.OPUS_OK}getPacketLossperc(){if(this.#e.originalRuntime()._opus_get_packet_loss_perc(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_PACKET_LOSS_PERC");return this.#o.value()}setDtx(e){return this.#e.originalRuntime()._opus_set_dtx(this.#s,e)===n.OPUS_OK}getDtx(){if(this.#e.originalRuntime()._opus_get_dtx(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_DTX");return this.#o.value()}setLsbDepth(e){return this.#e.originalRuntime()._opus_set_lsb_depth(this.#s,e)===n.OPUS_OK}getLsbDepth(){if(this.#e.originalRuntime()._opus_get_lsb_depth(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_LSB_DEPTH");return this.#o.value()}setExpertFrameduration(e){return this.#e.originalRuntime()._opus_set_expert_frame_duration(this.#s,e)===n.OPUS_OK}getExpertFrameduration(){if(this.#e.originalRuntime()._opus_get_expert_frame_duration(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_EXPERT_FRAME_DURATION");return this.#o.value()}setPredictionDisabled(e){return this.#e.originalRuntime()._opus_set_prediction_disabled(this.#s,e)===n.OPUS_OK}getPredictionDisabled(){if(this.#e.originalRuntime()._opus_get_prediction_disabled(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_PREDICTION_DISABLED");return this.#o.value()}getBandwidth(){if(this.#e.originalRuntime()._opus_get_bandwidth(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_BANDWIDTH");return this.#o.value()}getSampleRate(){if(this.#e.originalRuntime()._opus_get_sample_rate(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_SAMPLE_RATE");return this.#o.value()}setPhaseInversiondisabled(e){return this.#e.originalRuntime()._opus_set_phase_inversion_disabled(this.#s,e)===n.OPUS_OK}getPhaseInversiondisabled(){if(this.#e.originalRuntime()._opus_get_phase_inversion_disabled(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_PHASE_INVERSION_DISABLED");return this.#o.value()}getInDtx(){if(this.#e.originalRuntime()._opus_get_in_dtx(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_IN_DTX");return this.#o.value()}setGain(e){return this.#e.originalRuntime()._opus_set_gain(this.#s,e)===n.OPUS_OK}getGain(){if(this.#e.originalRuntime()._opus_get_gain(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_GAIN");return this.#o.value()}getLastPacketduration(){if(this.#e.originalRuntime()._opus_get_last_packet_duration(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_LAST_PACKET_DURATION");return this.#o.value()}getPitch(){if(this.#e.originalRuntime()._opus_get_pitch(this.#s,this.#o.offset())!=n.OPUS_OK)throw new Error("Failed to set OPUS_GET_PITCH");return this.#o.value()}}class a extends u{#n;#e;#u;#a;#f;#_;constructor(e,t,r,n,u,a){const f=new i(e),_=e.originalRuntime()._opus_encoder_create(t,r,n,f.offset());if(super(e,_),this.#_=new s,this.#n=f,this.#e=e,this.#f=new o(e,a),this.#a=new o(e,u),this.#_.add(this.#a),this.#_.add(this.#f),this.#_.add(this.#n),this.#u=_,f.value()<0)throw new Error("Failed to create encoder");if(!u)throw new Error("outBufferLength must be more than 0")}encoded(){return this.#a.data()}encodeFloat(e,t,r){if(r>this.#a.size())throw new Error(`encoded buffer length is ${this.#a.size()}, but maxDataBytes is ${r}`);this.#f.data().set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength));const i=this.#e.originalRuntime()._opus_encode_float(this.#u,this.#f.offset(),t,this.#a.offset(),r);if(i<0)throw new Error("Failed to encode float");return i}destroy(){this.#_.destroy(),this.#e.originalRuntime()._opus_encoder_destroy(this.#u)}}class f{#n;#h;#_;#e;#f;#l;constructor(e,t,r,n){if(this.#l=n,this.#e=e,this.#_=new s,this.#n=new i(e),this.#_.add(this.#n),this.#h=e.originalRuntime()._opus_decoder_create(t,r,this.#n.offset()),!this.#h||this.#n.value()<0)throw new Error("Failed to create decoder");this.#f=new o(e,this.#l*r*Float32Array.BYTES_PER_ELEMENT)}#d=null;decodeFloat(e,t=0){let r=this.#d;r||(r=new o(this.#e,e.byteLength)),r.data().byteLength<e.byteLength&&(r.destroy(),r=new o(this.#e,e.byteLength)),r.data().set(e),this.#d=r;const i=this.#e.originalRuntime()._opus_decode_float(this.#h,r.offset(),e.byteLength,this.#f.offset(),this.#l,t);if(i<0)throw new Error("Failed to decode float");return i}decoded(){const e=this.#f.data();return new Float32Array(e.buffer,e.byteOffset,e.byteLength/Float32Array.BYTES_PER_ELEMENT)}destroy(){this.#e.originalRuntime()._opus_decoder_destroy(this.#h),this.#_.destroy(),this.#d?.destroy()}}class _{#O;#c;#p;#l;constructor(e){this.#c=0,this.#p=0,this.#O=new ArrayBuffer(this.#E()),this.#l=e}#m(){return new Float32Array(this.#O)}write(e){this.#S(e.length),this.#m().set(e,this.#p),this.#p+=e.length}drain(){const e=this.#p-this.#c;return this.#P(e>=this.#l?this.#l:e)}read(){return this.#P(this.#l)}#P(e){if(!e)return null;if(this.#p-this.#c>=e){const t=this.#m().subarray(this.#c,this.#c+e);return this.#c+=e,this.#c>=this.#p&&(this.#p=0,this.#c=0),t}return null}#S(e){const t=e*Float32Array.BYTES_PER_ELEMENT;if(this.#m().length-this.#p<=e){const e=this.#O;this.#O=new ArrayBuffer(e.byteLength+t+this.#E()),this.#m().set(new Float32Array(e))}}#E(){return this.#l*Float32Array.BYTES_PER_ELEMENT*2}}},188:function(e,t,r){var i=this&&this.__decorate||function(e,t,r,i){var s,o=arguments.length,n=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,i);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(n=(o<3?s(n):o>3?s(t,r,n):s(t,r))||n);return o>3&&n&&Object.defineProperty(t,r,n),n};Object.defineProperty(t,"__esModule",{value:!0});const s=r(572),o=r(163);class n extends AudioWorkletProcessor{#g=null;#w=!0;static get parameterDescriptors(){return[{name:"frameSize"},{name:"debug"}]}constructor(...e){super(e),this.port.addEventListener("message",this.onMessage),this.port.start()}process(e,t,r){const i=r.frameSize[0],s=!!r.debug[0];this.#g||(this.#g=new o.RingBuffer(i)),e.length||console.error("no data available in input list: %o",e);for(const t of e){if(!t.length){console.error("channel available, but no data: %o",t);break}this.#g.write(t[0]);const e=this.#g.read();e&&(s&&console.log("read %d samples out from ring buffer",e.length),this.port.postMessage({samples:e}));break}if(!this.#w){let e;do{e=this.#g.drain(),null!==e&&this.port.postMessage({samples:e})}while(null!==e)}return this.#w}onMessage(e){e.data&&e.data.stop&&(this.#w=!1)}}i([s.boundMethod],n.prototype,"onMessage",null),registerProcessor("default-audio-processor",n)}},t={};function r(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(188)})();